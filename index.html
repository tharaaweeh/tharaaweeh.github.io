<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Taraaweeh 1447 | Masjid Al-Zikra</title>

<style>
:root{
  --bg:#0b1220;
  --card:#111a2e;
  --border:#1f2a44;
  --accent:#3b82f6;
  --success:#22c55e;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{box-sizing:border-box;font-family:Inter,system-ui}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  padding:48px 16px;
}

.container{max-width:960px;margin:auto}

header{margin-bottom:40px}
header h1{margin:0 0 8px;font-size:2.2rem}
header p{margin:0;color:var(--muted)}

.week{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:24px;
  margin-bottom:28px;
}

.day{
  border:1px solid var(--border);
  border-radius:12px;
  padding:16px;
  margin-bottom:14px;
}

.row{
  display:flex;
  align-items:center;
  gap:14px;
}

.checkbox{
  width:24px;
  height:24px;
  border-radius:6px;
  border:2px solid var(--border);
  display:grid;
  place-items:center;
  cursor:pointer;
  transition:.2s;
}

.checkbox svg{
  width:16px;
  height:16px;
  stroke:#fff;
  stroke-width:3;
  opacity:0;
}

.day.checked .checkbox{
  background:var(--success);
  border-color:var(--success);
}

.day.checked .checkbox svg{opacity:1}

.text{
  flex:1;
}

.day.checked .text{
  text-decoration:line-through;
  color:var(--muted);
}

.notes-btn{
  background:none;
  border:1px solid var(--border);
  color:var(--text);
  padding:6px 14px;
  border-radius:8px;
  cursor:pointer;
}

.notes-btn:hover{
  border-color:var(--accent);
  color:var(--accent);
}

.notes{
  display:none;
  margin-top:14px;
}

.notes.active{display:block}

.slot{
  background:#0f172a;
  border:1px solid var(--border);
  border-radius:8px;
  padding:10px;
  margin-bottom:10px;
}

.slot textarea{
  width:100%;
  background:none;
  border:none;
  resize:none;
  color:var(--text);
  outline:none;
}
</style>
</head>

<body>
<div class="container">

<header>
  <h1>Taraaweeh Schedule</h1>
  <p>Masjid Al-Zikuraa</p>
</header>

<div id="weeks"></div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import {
  getFirestore,
  doc,
  setDoc,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

/* Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyAQyGUzfrQQrksE2uE8cIa3oU9M6MB8-Cw",
  authDomain: "tharaaweeh-zikra.firebaseapp.com",
  projectId: "tharaaweeh-zikra",
  storageBucket: "tharaaweeh-zikra.firebasestorage.app",
  messagingSenderId: "508291079906",
  appId: "1:508291079906:web:445cb25b57136fce00c8bb"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* Schedule */
const schedule = [
["Week 1",
 "Wednesday – pages 3–6",
 "Thursday – pages 7–10",
 "Friday – pages 11–14",
 "Saturday – pages 15–18"
],
["Week 2",
 "Wednesday – pages 19–22",
 "Thursday – pages 23–26",
 "Friday – pages 27–30",
 "Saturday – pages 31–34"
],
["Week 3",
 "Wednesday – pages 35–38",
 "Thursday – pages 39–42",
 "Friday – pages 43–46",
 "Saturday – pages 47–50"
],
["Week 4",
 "Wednesday – pages 51–54",
 "Thursday – pages 55–58",
 "Friday – pages 59–62",
 "Saturday – pages 63–66"
],
["Week 5",
 "Wednesday – pages 67–70",
 "Thursday – pages 71–74",
 "Friday – pages 75–78",
 "Saturday – pages 79–82"
],
["Week 6",
 "Wednesday – pages 83–86",
 "Thursday – pages 87–90",
 "Friday – pages 91–94",
 "Saturday – pages 95–98"
],
["Week 7",
 "Wednesday – pages 99–102",
 "Thursday – pages 103–106",
 "Friday – pages 107–110",
 "Saturday – pages 111–114"
],
["Week 8",
 "Wednesday – pages 115–118",
 "Thursday – pages 119–122"
]
];

const container = document.getElementById("weeks");
let dayId = 0;

schedule.forEach(week=>{
  const card=document.createElement("div");
  card.className="week";
  card.innerHTML=`<h2>${week[0]}</h2>`;

  week.slice(1).forEach(text=>{
    const id = dayId++;
    const ref = doc(db,"days",`day_${id}`);

    const day=document.createElement("div");
    day.className="day";

    day.innerHTML=`
      <div class="row">
        <div class="checkbox">
          <svg viewBox="0 0 24 24" fill="none">
            <polyline points="4 12 9 17 20 6"/>
          </svg>
        </div>
        <div class="text">${text}</div>
        <button class="notes-btn">Imams</button>
      </div>
      <div class="notes">
        ${[0,1,2,3].map(s=>`
          <div class="slot">
            <textarea
              placeholder="Tharweeh ${s+1}"
              data-slot="${s}"></textarea>
          </div>
        `).join("")}
      </div>
    `;

    /* Checkbox toggle */
    const checkbox = day.querySelector(".checkbox");
    checkbox.onclick = () =>
      setDoc(ref,{ checked: !day.classList.contains("checked") },{ merge:true });

    /* Sync checkbox */
    onSnapshot(ref,snap=>{
      if(!snap.exists()) return;
      day.classList.toggle("checked", !!snap.data().checked);
    });

    /* Notes */
    const notes = day.querySelector(".notes");
    day.querySelector(".notes-btn").onclick =
      ()=>notes.classList.toggle("active");

    day.querySelectorAll("textarea").forEach(t=>{
      onSnapshot(ref,snap=>{
        if(!snap.exists()) return;
        t.value = snap.data()[t.dataset.slot] || "";
      });

      t.oninput = () =>
        setDoc(ref,{ [t.dataset.slot]: t.value },{ merge:true });
    });

    card.appendChild(day);
  });

  container.appendChild(card);
});
</script>

</body>
</html>
